# Versioning both explicit and implicit pip dependencies with `pip-tools` and `pip-compile`

# Problem

Sometimes it can be helpful to track both explicit and implicit depedencies. E.g., when you install a package like `pandas` and `seaborn`, `pip` will also install other implicit dependencies -- not specified by you -- including `numpy` and more.

Say you you have `requirements.txt` with a package to install like:

```
# requirements.txt
pandas
polars[pandas]
seaborn
```

... or you directly install like

```
python -m pip install pandas polars[pandas] seaborn
```

You want to pin all dependencies to a version number and define them in `requirements.txt`, so you run something like 

```
python -m pip freeze > requirements.txt
```

Now `requirements.txt` should look something like below:

```
# requirements.txt
build==1.2.2.post1
click==8.1.8
contourpy==1.3.1
cycler==0.12.1
fonttools==4.55.3
kiwisolver==1.4.8
matplotlib==3.10.0
numpy==2.2.1
packaging==24.2
pandas==2.2.3
pillow==11.1.0
pip-tools==7.4.1
polars==1.19.0
pyarrow==19.0.0
pyparsing==3.2.1
pyproject_hooks==1.2.0
python-dateutil==2.9.0.post0
pytz==2024.2
seaborn==0.13.2
six==1.17.0
tzdata==2024.2
```

Yours may look different than mine since I did not originally pin the initial installation.

It's hard to know what package(s) is/are using `numpy`. Also, if I run `python -m pip uninstall pandas`, I remove pandas but the implicit dependencies are still installed whether I need them or not.

# Solution

Install [pip-tools (github.com)](https://github.com/jazzband/pip-tools/) in your virtual environment and use `pip-compile` with a `requirements.in` file.

## Steps

Set up your virtual environment.

```
$ python3 -m venv venv

# modify for your OS or shell as needed
$ source venv/bin/activate
```

Install `pip-tools`.

```
python -m pip install pip-tools
```

In `requirements.in`, list your explicit dependencies.

```
# requirements.in
pandas
polars[pandas]
seaborn
```

Now run:

```
pip-compile
```

`pip-compile` will generate a `requirements.txt` file that looks like below.

```
# requirements.txt
#
# This file is autogenerated by pip-compile with Python 3.11
# by the following command:
#
#    pip-compile
#
contourpy==1.3.1
    # via matplotlib
cycler==0.12.1
    # via matplotlib
fonttools==4.55.3
    # via matplotlib
kiwisolver==1.4.8
    # via matplotlib
matplotlib==3.10.0
    # via seaborn
numpy==2.2.1
    # via
    #   contourpy
    #   matplotlib
    #   pandas
    #   seaborn
packaging==24.2
    # via matplotlib
pandas==2.2.3
    # via
    #   -r requirements.in
    #   polars
    #   seaborn
pillow==11.1.0
    # via matplotlib
polars[pandas,pyarrow]==1.19.0
    # via -r requirements.in
pyarrow==19.0.0
    # via polars
pyparsing==3.2.1
    # via matplotlib
python-dateutil==2.9.0.post0
    # via
    #   matplotlib
    #   pandas
pytz==2024.2
    # via pandas
seaborn==0.13.2
    # via -r requirements.in
six==1.17.0
    # via python-dateutil
tzdata==2024.2
    # via pandas
```

You now have 1/ explicit dependencies in `requirements.in` and 2/ all of your implicit and explicit pinned in `requirementst.txt`.

Notice under the package `python-dateutil`, you can see it is used by both `matplotlib` and `pandas`.

Intall your pinned dependencies like you would before.

```
python -m pip install -r requirements.txt
```
